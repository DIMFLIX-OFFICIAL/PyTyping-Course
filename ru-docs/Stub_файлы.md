# Типизация и сторонние библиотеки
Работа с типами в Python становится особенно важной, когда вы используете сторонние библиотеки. В этом разделе мы рассмотрим, как эффективно интегрировать типизацию в проекты, использующие внешние зависимости, а также как создавать стаб-файлы для библиотек, которые не предоставляют аннотации типов.

## Что такое стаб-файлы?
Стаб-файлы (или stub files) — это специальные файлы с расширением `.pyi`, которые используются в **Python** для предоставления информации о типах данных в коде, особенно когда речь идет о внешних библиотеках, которые не содержат аннотаций типов. Они позволяют разработчикам использовать преимущества статической типизации, не изменяя исходный код библиотек.

## Зачем нужны?
В Python, как и в других языках программирования, типизация помогает избежать ошибок, связанных с неправильным использованием данных. Например, если функция ожидает получить число, а вы передаете строку, это может привести к ошибкам во время выполнения программы. Стаб-файлы помогают:
- **Указать ожидаемые типы аргументов и возвращаемых значений**: Это позволяет статическим анализаторам кода и IDE (например, PyCharm или VSCode) проверять ваш код на наличие ошибок до его выполнения.
- **Упростить работу с нетипизированными библиотеками**: Если вы используете стороннюю библиотеку, которая не поддерживает аннотации типов, вы можете создать стаб-файл для этой библиотеки и указать в нем необходимые типы.

## Как работают?
Стаб-файлы содержат описание функций и классов, которые предоставляет библиотека, но без их реализации. Вместо этого они используют многоточие (`...`), чтобы указать, что реализация находится в другом месте. Например:

```python
# my_library.pyi 
def my_function(param: int) -> str: ...
```

В этом примере мы указываем, что функция `my_function` принимает один аргумент типа `int` и возвращает значение типа `str`.

## Как создать стаб-файл?
1. **Определите функции и классы**: Изучите исходный код модуля, чтобы понять, какие функции и классы он предоставляет.
2. **Создайте файл с расширением `.pyi`**: Например, если ваш модуль называется `my_library`, создайте файл `my_library.pyi`.
3. **Опишите типы**: Внутри файла укажите типы для всех функций и классов.

Пример стаб-файла для простой библиотеки:
```python
# my_library.pyi 
def add(a: int, b: int) -> int: ... 

def greet(name: str) -> str: ...
```

Если у вас есть сложная структура, организуйте стаб-файлы в подкаталоги с использованием `__init__.pyi` для пакетов.

## Где разместить стаб-файлы?
Стаб-файлы могут быть размещены в разных местах:
- **В той же директории, что и библиотека**: Это самый простой способ.
- **В отдельной папке**: Вы можете создать папку для всех ваших стаб-файлов и добавить её в переменную окружения `MYPYPATH`, чтобы Python мог их найти.

Пример добавления пути к стаб-файлам:
```bash
export MYPYPATH=~/path/to/stubs
```

## Генерация стаб-файлов
- **Использование `stubgen`**: Вы можете использовать инструмент `stubgen`, который входит в пакет `mypy`, чтобы автоматически генерировать стаб-файлы для сторонних библиотек:
```bash
    pip install -U mypy stubgen -m library_name
``` 
- Сгенерированные файлы будут сохранены в директории `out/`. Однако имейте в виду, что автоматически сгенерированные файлы могут не содержать полной информации о типах и документации.
- **Использование сторонних проектов**: Существуют проекты, которые предоставляют готовые стаб-файлы для популярных библиотек. Вы можете скачать их и разместить в директории с установленным модулем.